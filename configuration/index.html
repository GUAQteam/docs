



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the GUAQ Project">
      
      
        <link rel="canonical" href="https://guaqteam.github.io/docs/configuration/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Device Configuration - The GUAQ Initiative</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.750b69bd.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#device-configuration" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://guaqteam.github.io/docs/" title="The GUAQ Initiative" class="md-header-nav__button md-logo">
          
            <img src="../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              The GUAQ Initiative
            </span>
            <span class="md-header-nav__topic">
              Device Configuration
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://guaqteam.github.io/docs/" title="The GUAQ Initiative" class="md-nav__button md-logo">
      
        <img src="../images/logo.png" width="48" height="48">
      
    </a>
    The GUAQ Initiative
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Device Configuration
      </label>
    
    <a href="./" title="Device Configuration" class="md-nav__link md-nav__link--active">
      Device Configuration
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrade-instructions" title="Upgrade Instructions" class="md-nav__link">
    Upgrade Instructions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-process" title="Upgrade Process" class="md-nav__link">
    Upgrade Process
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-the-guaq-distribution-10-minutes" title="Download the GUAQ Distribution (10 minutes)" class="md-nav__link">
    Download the GUAQ Distribution (10 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-the-guaq-software-5-minutes" title="Extract the GUAQ Software (5 minutes)" class="md-nav__link">
    Extract the GUAQ Software (5 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-guaq-for-the-site-1-hour" title="Configure GUAQ For The Site (1 hour)" class="md-nav__link">
    Configure GUAQ For The Site (1 hour)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-ampy-and-pip-utilities-10-minutes" title="Install Ampy, and Pip Utilities (10 minutes)" class="md-nav__link">
    Install Ampy, and Pip Utilities (10 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-guaq-10-minutes" title="Upgrade GUAQ (10 minutes)" class="md-nav__link">
    Upgrade GUAQ (10 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confirm-guaq-functionality-5-minutes" title="Confirm GUAQ Functionality (5 minutes)" class="md-nav__link">
    Confirm GUAQ Functionality (5 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete" title="Complete!" class="md-nav__link">
    Complete!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrade-instructions" title="Upgrade Instructions" class="md-nav__link">
    Upgrade Instructions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-process" title="Upgrade Process" class="md-nav__link">
    Upgrade Process
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-the-guaq-distribution-10-minutes" title="Download the GUAQ Distribution (10 minutes)" class="md-nav__link">
    Download the GUAQ Distribution (10 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-the-guaq-software-5-minutes" title="Extract the GUAQ Software (5 minutes)" class="md-nav__link">
    Extract the GUAQ Software (5 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-guaq-for-the-site-1-hour" title="Configure GUAQ For The Site (1 hour)" class="md-nav__link">
    Configure GUAQ For The Site (1 hour)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-ampy-and-pip-utilities-10-minutes" title="Install Ampy, and Pip Utilities (10 minutes)" class="md-nav__link">
    Install Ampy, and Pip Utilities (10 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-guaq-10-minutes" title="Upgrade GUAQ (10 minutes)" class="md-nav__link">
    Upgrade GUAQ (10 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confirm-guaq-functionality-5-minutes" title="Confirm GUAQ Functionality (5 minutes)" class="md-nav__link">
    Confirm GUAQ Functionality (5 minutes)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete" title="Complete!" class="md-nav__link">
    Complete!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="device-configuration">Device Configuration</h1>
<h2 id="upgrade-instructions">Upgrade Instructions</h2>
<h3 id="prerequisites">Prerequisites</h3>
<p><strong>Supported Operating Systems.</strong>  At present, the upgrade supports only Mac OS
X (10.12 or higher) and Linux operating systems. This tool has been tested with
Python 2 and 3 on Mac OS X 10.14, Raspian Buster 10, and GalliumOS 2.1 systems.
Some familiarity with using the command line interface (CLI) of these operating
systems is required.</p>
<p><strong>Internet Access.</strong> The GUAQ application is hosted on Georgetown University’s
<a href="https://github.com/GeorgetownMakerHubOrg">GitHub repository</a>. Access to this
software distribution as well as other git repositories prior to upgrade is
required. The actual upgrade process will require internet access as it will
create the IoT group on <a href="https://io.adafruit.com">Adafruit I/O</a> for the GUAQ
monitor.</p>
<p><strong>USB Cable.</strong>  Some USB cables supply only power.  Please use the supplied USB
cable which provides both power and data connections to the GUAQ monitor.</p>
<p><strong>Additional Tools and Utilities.</strong> The upgrade tool requires <code>pip</code> (Python
package manager) <code>screen</code> (serial interface tool), and <code>ampy</code> (file transfer
tool).  Details for installing these packages are provided below.</p>
<p><strong>Upgrade mode.</strong> The GUAQ must be in upgrade mode for this procedure. To enter
upgrade mode, remove the base unit from the Stevenson screen enclosure.</p>
<h3 id="upgrade-process">Upgrade Process</h3>
<p>There are 6 basic steps. Individuals new to the upgrade process should schedule
2 hours for the entire procedure:</p>
<ol>
<li>Download the GUAQ Distribution <em>(10 minutes)</em></li>
<li>Extract the GUAQ Software <em>(5 minutes)</em></li>
<li>Configure GUAQ For The Local Site <em>(1 hour)</em></li>
<li>Install Necessary Tools <em>(10 minutes)</em></li>
<li>Upgrade GUAQ monitor <em>(10 minutes)</em></li>
<li>Confirm GUAQ Functionality <em>(5 minutes)</em></li>
</ol>
<h4 id="download-the-guaq-distribution-10-minutes">Download the GUAQ Distribution <em>(10 minutes)</em></h4>
<p>Using a web browser, visit the <a href="https://github.com/GeorgetownMakerHubOrg/air-quality">GUAQ
repository</a>. Download the
GUAQ file using the</p>
<p><img alt="Clone or Download Button" src="../images/instructions/clone-or-download.png" /></p>
<p>button on the right side of the page. Use the <code>Download Zip</code> button (see red
arrow) to save it to a directory of your choice (e.g.  /Users/guaqteam/guaq).</p>
<p><img alt="Download Zip" src="../images/instructions/download-zip.png" /></p>
<h4 id="extract-the-guaq-software-5-minutes">Extract the GUAQ Software <em>(5 minutes)</em></h4>
<p>Open the Terminal application located under the Mac OS X Utilities. For Linux
users, open a terminal window. Change the current working directory to where
<strong>air-quality-master.zip</strong> resides and run <code>unzip air-quality-master.zip</code>:</p>
<pre><code>MacBook:~ guaqteam$ cd
MacBook:~ guaqteam$ pwd
/Users/guaqteam
MacBook:~ guaqteam$ ls -l
total 3640
-rw-r--r--@ 1 guaqteam  staff  1862164 Aug 12 17:45 air-quality-master.zip
MacBook:~ guaqteam$ unzip air-quality-master.zip
</code></pre>

<h4 id="configure-guaq-for-the-site-1-hour">Configure GUAQ For The Site (1 hour)</h4>
<p>The GUAQ distribution includes a generic configuration (<code>config-generic.py</code>)
file that needs modification to accommodate site specific parameters. These
include, among others, the GUAQ geolocation and Wifi credentials.</p>
<pre><code># Geolocation information
# Default on Carroll's statue: lat=38.907606, lon=-77.072257
LATITUDE = 38.907606
LONGITUDE = -77.072257

# Wifi Parameters
STA_SSID = &quot;GuestNet&quot;
STA_PASSWORD = &quot;GoHoyaSaxa&quot;
AP_SSID = &quot;STIA436-fpg&quot;  # use an SSID that combines class and GUID to make it
unique.
AP_PASSWORD = &quot;HillTopHoyas&quot;

# Adafruit
X_AIO_KEY = &quot;Io.Adafruit.X_AIO_KEY025ea3251b199c42f4520&quot;
USER = &quot;IO-ADAFRUIT-USER-NAME&quot;
GROUP = &quot;Adafruit-Group-Name&quot;

# ThingSpeak - Write API Key
TS_KEY = &quot;THINGSPEAKWRITEKEY&quot;

# Sleep time for wake/sleep cycle in milliseconds
SLEEP = 60 * 1000

# Capacitive Touch Parameters
TOUCH_PIN = 13
TOUCH_THRESHOLD = 100

# Enable Debugging Statements
DEBUG = True
</code></pre>

<p>Copy this file to <code>config.py</code> and use <code>nano</code>, <code>vi</code>, or preferred text editor to
modify the above parameters in config.py. The GUAQ team will supply the
Adafruit <strong>X_AIO_KEY</strong>, <strong>USER</strong> and <strong>GROUP</strong> values:</p>
<pre><code>MacBook:air-quality-master guaqteam$ cp config-generic.py config.py
MacBook:air-quality-master guaqteam$ nano config.py
</code></pre>

<h4 id="install-ampy-and-pip-utilities-10-minutes">Install Ampy, and Pip Utilities <em>(10 minutes)</em></h4>
<p>On Mac OS X, <code>pip</code> is not installed by default. To install it on OS X, use:</p>
<pre><code>MacBook:air-quality-master guaqteam$ sudo easy_install pip
Password: ********
Searching for pip
Best match: pip 18.0
Adding pip 18.0 to easy-install.pth file
Installing pip script to /anaconda3/bin
Installing pip3 script to /anaconda3/bin
Installing pip3.7 script to /anaconda3/bin

Using /anaconda3/lib/python3.6/site-packages
Processing dependencies for pip
Finished processing dependencies for pip
</code></pre>

<p>Follow <a href="https://github.com/pycampers/ampy">Adafruit’s instructions</a> to install
ampy. Briefly, for Python2 on the Mac, it’s:</p>
<pre><code>MacBook:air-quality-master guaqteam$ sudo pip install adafruit-ampy
</code></pre>

<p><strong>Optional:</strong> The GUAQ git repository and accompanying <code>upload.py</code> tool also
supports a full restore (re-installation) of the latest, stable MicroPython
interpreter (1.11). If it becomes necessary to reset the GUAQ, the esptool.py
will need to be installed. Instructions for installing esptool.py can be found
<a href="https://github.com/espressif/esptool">here</a>. For Python2 on the Mac, the
command should be:</p>
<pre><code>MacBook:air-quality-master guaqteam$ pip install esptool
</code></pre>

<h4 id="upgrade-guaq-10-minutes">Upgrade GUAQ <em>(10 minutes)</em></h4>
<p>While the GUAQ team has developed a web-based, network file transfer tool, this
capability has not been fully tested and documented. For the current release, a
USB serial file transfer is required.</p>
<p>Upgrade mode is enabled by sensing touch on Pin 13 of the GUAQ processor.
Placing a finger on Pin 13 of the shield for 10 seconds while attaching GUAQ to
the laptop/computer will put GUAQ into upgrade mode.</p>
<p><img alt="Upgrade Mode" src="../images/instructions/upgrade_pin.jpg" /></p>
<p>Run the following <code>python bin/upload.py</code> and when prompted, attach the GUAQ
using the above upgrade technique.</p>
<p>The following output (note the GUAQ Id) is expected:</p>
<p><img alt="Upload Command Output" src="../images/instructions/upload_output.png" /></p>
<h4 id="confirm-guaq-functionality-5-minutes">Confirm GUAQ Functionality <em>(5 minutes)</em></h4>
<p>If the upgrade is successful and communicating with the Adafruit IoT service,
data will post at !(https://io.adafruit.com/fpg13/feeds). The GUAQ team will
provide the username and password to access this account.</p>
<p><img alt="Adafruit I/O" src="../images/instructions/adafruit_io_groups.png" /></p>
<p>GUAQ also has a console that is accessible over the serial interface. The
<code>screen</code> utility is the best tool for this purpose, however, Raspian and
GalliumOS do not include the <code>screen</code> utility by default. To add this tool, use
the linux update tool <code>apt-get</code>:</p>
<pre><code>GalliumOS:air-quality-master guaqteam$ sudo apt-get install screen
</code></pre>

<p>Next, identify the serial port attached to GUAQ. The default serial names for
each operating system are:</p>
<table>
<thead>
<tr>
<th>OS</th>
<th>Device</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mac OS X 10.4</td>
<td>/dev/tty.usbserial-<number></td>
<td>/dev/tty.usbserial-1410</td>
</tr>
<tr>
<td>Raspian Buster</td>
<td>/dev/ttyUSB<number></td>
<td>/dev/ttyUSB0</td>
</tr>
<tr>
<td>GalliumOS</td>
<td>/dev/ttyUSB<number></td>
<td>/dev/ttyUSB0</td>
</tr>
</tbody>
</table>
<p>From a terminal, use the <code>ls</code> command to locate the serial port that’s in use.
On Mac OS X, this command would be:</p>
<pre><code>MacBook:air-quality~ guaqteam$
MacBook:air-quality~ guaqteam$ ls -l /dev/tty.usb*
crw-rw-rw-  1 root  wheel   18,  24 Aug 13 10:40 /dev/tty.usbserial-1410
MacBook-Pro:air-quality~ guaqteam$
</code></pre>

<p>Using this serial port, launch:</p>
<pre><code>MacBook:~ guaqteam$ screen /dev/tty.usbserial-1410 115200
</code></pre>

<p>To exit <code>screen</code>, the sequence <code>Ctrl-A</code> then the letter <code>K</code> will end the
session.  Keep in mind that the GUAQ might be in deep-sleep when the connection
is made so don’t expect immediate console output!</p>
<h4 id="complete">Complete!</h4>
<p>Congratulations, you have made it through the GUAQ upgrade process!</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/guaqteam" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://instagram.com/guaqteam" class="md-footer-social__link fa fa-instagram"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>